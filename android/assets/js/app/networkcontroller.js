// Generated by CoffeeScript 1.3.3
(function() {

  define(["jquery"], function($) {
    return {
      buildUrl: function(path) {
        return $(document.body).data('base') + path;
      },
      addUser: function(username, password, publickey, successCallback, errorCallback) {
        var user;
        user = {};
        user.username = username;
        user.password = password;
        user.publickey = publickey;
        return $.post(this.buildUrl("/users"), JSON.stringify(user)).success(successCallback).error(errorCallback);
      },
      login: function(username, password, successCallback, errorCallback) {
        console.log("login");
        return $.post(this.buildUrl("/login"), "{\"username\":\"" + username + "\",\"password\":\"" + password + "\"}").success(successCallback).error(errorCallback);
      },
      logout: function(successCallback, errorCallback) {
        return $.ajax({
          type: "POST",
          url: this.buildUrl("/logout"),
          dataType: "json",
          contentType: "application/json",
          success: successCallback,
          error: errorCallback
        });
      },
      getConversationKey: function(room, successCallback, errorCallback) {
        return $.get(this.buildUrl("/conversations/" + room + "/key/")).success(successCallback).error(errorCallback);
      },
      getPublicKey: function(username, successCallback, errorCallback) {
        console.log("getpublickey");
        return $.get(this.buildUrl("/publickey/" + username)).success(successCallback).error(errorCallback);
      },
      getFriends: function(username, successCallback, errorCallback) {
        console.log("getFriends");
        return $.get(this.buildUrl("/friends")).success(successCallback).error(errorCallback);
      },
      getMessages: function(room, successCallback, errorCallback) {
        console.log("getMessages");
        return $.get(this.buildUrl("/conversations/" + room + "/messages")).success(successCallback).error(errorCallback);
      },
      invite: function(friendname, successCallback, errorCallback) {
        console.log("invite");
        return $.post(this.buildUrl("/invite/" + friendname)).success(successCallback).error(errorCallback);
      },
      respondToInvite: function(friendname, choice, successCallback, errorCallback) {
        return $.post(this.buildUrl("/invites/" + friendname + "/" + choice)).success(successCallback).error(errorCallback);
      },
      getNotifications: function(successCallback, errorCallback) {
        return $.get(this.buildUrl("/notifications")).success(successCallback).error(errorCallback);
      }
    };
  });

}).call(this);
